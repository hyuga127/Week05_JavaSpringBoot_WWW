<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Company Sign Up - Job Portal</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/css/modern-theme.css" />
    <style>
      body {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        min-height: 100vh;
        font-family: 'Inter', sans-serif;
        padding: 40px 20px;
      }

      .signup-container {
        max-width: 750px;
        margin: 0 auto;
      }

      .signup-card {
        background: rgba(255, 255, 255, 0.98);
        border-radius: 24px;
        padding: 3rem;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(10px);
        animation: fadeInUp 0.6s ease-out;
      }

      .header-section {
        text-align: center;
        margin-bottom: 2.5rem;
      }

      .icon-badge {
        width: 70px;
        height: 70px;
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        border-radius: 18px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        box-shadow: 0 10px 30px rgba(118, 75, 162, 0.4);
      }

      .icon-badge i {
        font-size: 2rem;
        color: white;
      }

      .signup-title {
        font-size: 2rem;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 0.5rem;
      }

      .signup-subtitle {
        color: #718096;
        font-size: 1rem;
      }

      .form-section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #2d3748;
        margin: 2rem 0 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid #e2e8f0;
        display: flex;
        align-items: center;
      }

      .form-section-title i {
        margin-right: 0.75rem;
        color: #764ba2;
      }

      .form-label {
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
      }

      .form-label .required {
        color: #f56565;
      }

      .form-control-modern {
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        padding: 0.75rem 1rem;
        transition: all 0.3s ease;
        font-size: 1rem;
      }

      .form-control-modern:focus {
        border-color: #764ba2;
        box-shadow: 0 0 0 4px rgba(118, 75, 162, 0.1);
        outline: none;
      }

      .email-check {
        font-size: 0.9rem;
        margin-top: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-submit {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        color: white;
        border: none;
        height: 50px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(118, 75, 162, 0.4);
        margin-top: 1rem;
      }

      .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(118, 75, 162, 0.5);
        color: white;
      }

      .alert-modern {
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border: none;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .alert-success {
        background: #f0fff4;
        color: #22543d;
      }

      .alert-danger {
        background: #fff5f5;
        color: #c53030;
      }

      .links-section {
        text-align: center;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid #e2e8f0;
      }

      .links-section p {
        color: #718096;
        margin-bottom: 0.5rem;
      }

      .links-section a {
        color: #764ba2;
        font-weight: 600;
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .links-section a:hover {
        color: #667eea;
      }

      .input-icon-wrapper {
        position: relative;
      }

      .input-icon {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #a0aec0;
      }

      .progress-bar {
        height: 5px;
        background: #e2e8f0;
        border-radius: 10px;
        margin-bottom: 2rem;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #764ba2 0%, #667eea 100%);
        transition: width 0.3s ease;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div class="signup-container">
      <div class="signup-card">
        <div class="header-section">
          <div class="icon-badge">
            <i class="fas fa-building"></i>
          </div>
          <h1 class="signup-title">Create Company Account</h1>
          <p class="signup-subtitle">Connect with top talent and build your dream team</p>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" style="width: 0%"></div>
        </div>

        <div id="alertContainer"></div>

        <form id="signupForm">
          <!-- Company Information -->
          <div class="form-section-title">
            <i class="fas fa-building"></i>
            <span>Company Information</span>
          </div>

          <div class="row">
            <div class="col-12 mb-3">
              <label for="name" class="form-label">
                Company Name <span class="required">*</span>
              </label>
              <div class="input-icon-wrapper">
                <input type="text" class="form-control form-control-modern" id="name" placeholder="Acme Corporation" required />
                <i class="fas fa-building input-icon"></i>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="email" class="form-label">
                Company Email <span class="required">*</span>
              </label>
              <div class="input-icon-wrapper">
                <input type="email" class="form-control form-control-modern" id="email" placeholder="contact@company.com" required />
                <i class="fas fa-envelope input-icon"></i>
              </div>
              <div id="emailCheck" class="email-check"></div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="phone" class="form-label">
                Phone Number <span class="required">*</span>
              </label>
              <div class="input-icon-wrapper">
                <input type="tel" class="form-control form-control-modern" id="phone" pattern="[0-9]{10,15}" placeholder="1234567890" required />
                <i class="fas fa-phone input-icon"></i>
              </div>
              <small class="form-text text-muted">10-15 digits</small>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="password" class="form-label">
                Password <span class="required">*</span>
              </label>
              <div class="input-icon-wrapper">
                <input type="password" class="form-control form-control-modern" id="password" minlength="6" placeholder="••••••••" required />
                <i class="fas fa-lock input-icon"></i>
              </div>
              <small class="form-text text-muted">Minimum 6 characters</small>
            </div>
            <div class="col-md-6 mb-3">
              <label for="webUrl" class="form-label">
                Website URL
              </label>
              <div class="input-icon-wrapper">
                <input type="url" class="form-control form-control-modern" id="webUrl" placeholder="https://www.company.com" />
                <i class="fas fa-globe input-icon"></i>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12 mb-3">
              <label for="about" class="form-label">
                About Company
              </label>
              <textarea
                class="form-control form-control-modern"
                id="about"
                rows="4"
                maxlength="2000"
                placeholder="Tell us about your company, culture, and what makes it a great place to work..."
              ></textarea>
              <small class="form-text text-muted">Maximum 2000 characters</small>
            </div>
          </div>

          <!-- Address Information -->
          <div class="form-section-title">
            <i class="fas fa-map-marker-alt"></i>
            <span>Company Address</span>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="street" class="form-label">
                Street <span class="required">*</span>
              </label>
              <input type="text" class="form-control form-control-modern" id="street" placeholder="123 Business Avenue" required />
            </div>
            <div class="col-md-6 mb-3">
              <label for="number" class="form-label">
                Number/Suite <span class="required">*</span>
              </label>
              <input type="text" class="form-control form-control-modern" id="number" placeholder="Suite 500" required />
            </div>
          </div>

          <div class="row">
            <div class="col-md-4 mb-3">
              <label for="city" class="form-label">
                City <span class="required">*</span>
              </label>
              <input type="text" class="form-control form-control-modern" id="city" placeholder="San Francisco" required />
            </div>
            <div class="col-md-4 mb-3">
              <label for="country" class="form-label">
                Country <span class="required">*</span>
              </label>
              <input type="text" class="form-control form-control-modern" id="country" placeholder="USA" required />
            </div>
            <div class="col-md-4 mb-3">
              <label for="zipcode" class="form-label">
                Zipcode <span class="required">*</span>
              </label>
              <input type="text" class="form-control form-control-modern" id="zipcode" placeholder="94102" required />
            </div>
          </div>

          <button type="submit" class="btn btn-submit w-100" id="submitBtn">
            <i class="fas fa-building me-2"></i>Create Company Account
          </button>
        </form>

        <div class="links-section">
          <p>
            Already have an account?
            <a href="/signin"><i class="fas fa-sign-in-alt"></i> Login here</a>
          </p>
          <p>
            <a href="/signup"><i class="fas fa-arrow-left"></i> Back to account type selection</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      let emailAvailable = false;

      // Progress bar update
      $('#signupForm input[required], #signupForm textarea').on('input', function() {
        const totalFields = $('#signupForm input[required]').length;
        const filledFields = $('#signupForm input[required]').filter(function() {
          return $(this).val() !== '';
        }).length;
        const progress = (filledFields / totalFields) * 100;
        $('.progress-fill').css('width', progress + '%');
      });

      // Email availability check
      $("#email").on("input", function () {
        const email = $(this).val();
        if (email && email.includes("@")) {
          $.ajax({
            url: "/api/v1/auth/check-email",
            method: "GET",
            data: { email: email },
            success: function (response) {
              if (response.data) {
                $("#emailCheck").html(
                  '<i class="fas fa-check-circle text-success"></i><span class="text-success">Email available</span>'
                );
                emailAvailable = true;
              } else {
                $("#emailCheck").html(
                  '<i class="fas fa-times-circle text-danger"></i><span class="text-danger">Email already registered</span>'
                );
                emailAvailable = false;
              }
            },
          });
        }
      });

      // Form submission
      $("#signupForm").on("submit", function (e) {
        e.preventDefault();

        if (!emailAvailable) {
          showAlert(
            "danger",
            "Email is already registered. Please use a different email."
          );
          return;
        }

        const companyData = {
          name: $("#name").val(),
          email: $("#email").val(),
          password: $("#password").val(),
          phone: $("#phone").val(),
          about: $("#about").val(),
          webUrl: $("#webUrl").val(),
          address: {
            street: $("#street").val(),
            city: $("#city").val(),
            country: $("#country").val(),
            number: $("#number").val(),
            zipcode: $("#zipcode").val(),
          },
        };

        $("#submitBtn")
          .prop("disabled", true)
          .html('<i class="fas fa-spinner fa-spin me-2"></i>Creating account...');

        $.ajax({
          url: "/api/v1/auth/signup/company",
          method: "POST",
          contentType: "application/json",
          data: JSON.stringify(companyData),
          success: function (response) {
            showAlert(
              "success",
              '<i class="fas fa-check-circle"></i> Company account created successfully! Redirecting to login...'
            );
            setTimeout(function () {
              window.location.href = "/signin";
            }, 2000);
          },
          error: function (xhr) {
            $("#submitBtn")
              .prop("disabled", false)
              .html('<i class="fas fa-building me-2"></i>Create Company Account');
            const error = xhr.responseJSON;
            if (error && error.validationErrors) {
              let errorMsg = '<strong>Please fix the following errors:</strong><br>';
              for (let field in error.validationErrors) {
                errorMsg += `• ${error.validationErrors[field]}<br>`;
              }
              showAlert("danger", errorMsg);
            } else {
              showAlert(
                "danger",
                '<i class="fas fa-exclamation-circle"></i> ' + (error?.message || "Registration failed. Please try again.")
              );
            }
          },
        });
      });

      function showAlert(type, message) {
        const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
        $("#alertContainer").html(
          `<div class="alert-modern ${alertClass}" role="alert">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%);"></button>
            </div>`
        );
        // Scroll to alert
        $('html, body').animate({
          scrollTop: $("#alertContainer").offset().top - 100
        }, 500);
      }
    </script>
  </body>
</html>